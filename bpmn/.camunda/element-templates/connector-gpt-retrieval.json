{
  "$schema": "https://unpkg.com/@camunda/zeebe-element-templates-json-schema/resources/schema.json",
  "name": "GPT Q&A Retrieval Connector",
  "id": "io.holunda.connector.retrieval.v1",
  "description": "Answers questions by retrieving information from a vector database.",
  "version": 1,
  "documentationRef": "https://docs.camunda.io/docs/components/connectors/out-of-the-box-connectors/available-connectors-overview/",
  "icon": {
    "contents": "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48IS0tIFVwbG9hZGVkIHRvOiBTVkcgUmVwbywgd3d3LnN2Z3JlcG8uY29tLCBHZW5lcmF0b3I6IFNWRyBSZXBvIE1peGVyIFRvb2xzIC0tPg0KPHN2ZyB3aWR0aD0iODAwcHgiIGhlaWdodD0iODAwcHgiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4NCjxwYXRoIGQ9Ik0xNyAxOC40MzAxSDEzTDguNTQ5OTkgMjEuMzlDNy44ODk5OSAyMS44MyA3IDIxLjM2MDEgNyAyMC41NjAxVjE4LjQzMDFDNCAxOC40MzAxIDIgMTYuNDMwMSAyIDEzLjQzMDFWNy40Mjk5OUMyIDQuNDI5OTkgNCAyLjQyOTk5IDcgMi40Mjk5OUgxN0MyMCAyLjQyOTk5IDIyIDQuNDI5OTkgMjIgNy40Mjk5OVYxMy40MzAxQzIyIDE2LjQzMDEgMjAgMTguNDMwMSAxNyAxOC40MzAxWiIgc3Ryb2tlPSIjMjkyRDMyIiBzdHJva2Utd2lkdGg9IjEuNSIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiLz4NCjxwYXRoIGQ9Ik0xMi4wMDAxIDExLjM2VjExLjE1QzEyLjAwMDEgMTAuNDcgMTIuNDIwMSAxMC4xMSAxMi44NDAxIDkuODIwMDFDMTMuMjUwMSA5LjU0MDAxIDEzLjY2IDkuMTgwMDIgMTMuNjYgOC41MjAwMkMxMy42NiA3LjYwMDAyIDEyLjkyMDEgNi44NTk5OSAxMi4wMDAxIDYuODU5OTlDMTEuMDgwMSA2Ljg1OTk5IDEwLjM0MDEgNy42MDAwMiAxMC4zNDAxIDguNTIwMDIiIHN0cm9rZT0iIzI5MkQzMiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPg0KPHBhdGggZD0iTTExLjk5NTUgMTMuNzVIMTIuMDA0NSIgc3Ryb2tlPSIjMjkyRDMyIiBzdHJva2Utd2lkdGg9IjEuNSIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+DQo8L3N2Zz4="
  },
  "category": {
    "id": "connectors",
    "name": "Connectors"
  },
  "appliesTo": ["bpmn:Task"],
  "elementType": {
    "value": "bpmn:ServiceTask"
  },
  "groups": [
    {
      "id": "model",
      "label": "Model"
    },
    {
      "id": "input",
      "label": "Input"
    },
    {
      "id": "database",
      "label": "Vector Database"
    },
    {
      "id": "query",
      "label": "Query"
    },
    {
      "id": "advanced",
      "label": "Advanced"
    },
    {
      "id": "output",
      "label": "Output Mapping"
    },
    {
      "id": "errors",
      "label": "Errors"
    }
  ],
  "properties": [
    {
      "type": "Hidden",
      "value": "io.holunda:connector-retrieval:1",
      "binding": {
        "type": "zeebe:taskDefinition:type"
      }
    },
    {
      "id": "model",
      "label": "LLM",
      "group": "model",
      "type": "Dropdown",
      "value": "GPT_3",
      "choices": [
        { "name": "OpenAI GPT-3.5 Turbo", "value": "GPT_3" },
        { "name": "OpenAI GPT-4", "value": "GPT_4" }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "model"
      }
    },
    {
      "id": "database_type",
      "label": "Vector Database",
      "group": "database",
      "type": "Dropdown",
      "value": "weaviate",
      "choices": [
        { "name": "Azure Cognitive Search", "value": "azure_cognitive_search" },
        { "name": "Weaviate", "value": "weaviate" }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "database.type"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "label": "Vector Database URL",
      "group": "database",
      "type": "String",
      "feel": "optional",
      "value": "http://localhost:8080/testIndex",
      "binding": {
        "type": "zeebe:input",
        "name": "database.url"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "label": "Vector Database Password / Key",
      "group": "database",
      "type": "String",
      "feel": "optional",
      "binding": {
        "type": "zeebe:input",
        "name": "database.password"
      },
      "condition": {
        "property": "database_type",
        "equals": "azure_cognitive_search"
      }
    },
    {
      "label": "Embedding Provider",
      "group": "database",
      "type": "Dropdown",
      "value": "openai",
      "choices": [
        { "name": "OpenAI", "value": "openai" },
        { "name": "Aleph Alpha", "value": "aleph-alpha" },
        { "name": "Cohere English", "value": "cohere-english" },
        { "name": "Cohere Multilingual", "value": "cohere-multi" }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "database.embedding.provider"
      }
    },
    {
      "label": "Embedding Model",
      "group": "database",
      "type": "String",
      "value": "text-embedding-ada-002",
      "binding": {
        "type": "zeebe:input",
        "name": "database.embedding.model"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "label": "Natural Language Query",
      "description": "The query or question to be answered.",
      "group": "query",
      "type": "Text",
      "feel": "optional",
      "value": "",
      "binding": {
        "type": "zeebe:input",
        "name": "query.query"
      },
      "constraints": {
        "notEmpty": true
      }
    },
    {
      "label": "Reranking",
      "group": "advanced",
      "type": "Dropdown",
      "value": "",
      "choices": [
        { "name": "None", "value": "" },
        { "name": "Cohere Rerank", "value": "cohere" }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.reranker"
      }
    },
    {
      "id": "filtering",
      "label": "Filtering",
      "group": "advanced",
      "type": "Dropdown",
      "value": "",
      "choices": [
        { "name": "None", "value": "" },
        { "name": "Auto Metadata Filter", "value": "metadata" },
        { "name": "Summary Index", "value": "summary" }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.filtering"
      }
    },
    {
      "label": "Summary Index",
      "group": "advanced",
      "type": "String",
      "feel": "optional",
      "value": "",
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.summaryIndex"
      },
      "condition": {
        "property": "filtering",
        "equals": "summary"
      }
    },
    {
      "label": "Filter Attribute",
      "group": "advanced",
      "type": "String",
      "feel": "optional",
      "value": "",
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.filterMetadataField"
      },
      "condition": {
        "property": "filtering",
        "equals": "summary"
      }
    },
    {
      "label": "Document Content Description",
      "group": "advanced",
      "type": "String",
      "feel": "optional",
      "optional": true,
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.documentDescription"
      },
      "condition": {
        "property": "filtering",
        "equals": "metadata"
      }
    },
    {
      "label": "Metadata Filtering",
      "description": "Schema of filterable metadata fields to automatically perform structured filtering.",
      "group": "advanced",
      "type": "Text",
      "feel": "optional",
      "optional": true,
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.fieldMetadata"
      },
      "condition": {
        "property": "filtering",
        "equals": "metadata"
      }
    },
    {
      "id": "parent_store",
      "label": "Parent Document Store",
      "group": "advanced",
      "type": "Dropdown",
      "value": "none",
      "choices": [
        { "name": "None", "value": "none" },
        { "name": "Azure Cosmos DB NoSQL", "value": "azure_cosmos_nosql" },
        { "name": "Redis", "value": "redis" }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.parentDocumentStore.type"
      }
    },
    {
      "label": "Document Store URL",
      "group": "advanced",
      "type": "String",
      "feel": "optional",
      "value": "",
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.parentDocumentStore.url"
      },
      "condition": {
        "property": "parent_store",
        "oneOf": ["redis", "azure_cosmos_nosql"]
      }
    },
    {
      "label": "Document Store Password",
      "group": "advanced",
      "type": "String",
      "feel": "optional",
      "value": "",
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.parentDocumentStore.password"
      },
      "condition": {
        "property": "parent_store",
        "oneOf": ["azure_cosmos_nosql"]
      }
    },
    {
      "label": "Document Store Namespace",
      "group": "advanced",
      "type": "String",
      "feel": "optional",
      "value": "",
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.parentDocumentStore.namespace"
      },
      "condition": {
        "property": "parent_store",
        "oneOf": ["redis", "azure_cosmos_nosql"]
      }
    },
    {
      "label": "Parent Document ID Field",
      "group": "advanced",
      "type": "String",
      "feel": "optional",
      "value": "parent_id",
      "binding": {
        "type": "zeebe:input",
        "name": "advanced.parentDocumentStore.parentDocumentId"
      },
      "condition": {
        "property": "parent_store",
        "oneOf": ["redis", "azure_cosmos_nosql"]
      }
    },
    {
      "id": "output_type",
      "label": "Output Type",
      "group": "query",
      "type": "Dropdown",
      "value": "natural",
      "choices": [
        { "name": "Natural Language Answer", "value": "natural" },
        { "name": "JSON", "value": "json" }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "query.outputType"
      }
    },
    {
      "label": "Output Schema",
      "description": "JSON schema for the output",
      "group": "query",
      "type": "Text",
      "feel": "required",
      "value": "={\n  name: \"full name\",\n  birthdate: \"birthday in ISO format\"\n}",
      "binding": {
        "type": "zeebe:input",
        "name": "query.outputSchema"
      },
      "condition": {
        "property": "output_type",
        "equals": "json"
      }
    },
    {
      "label": "Answer Synthesis Strategy",
      "group": "query",
      "type": "Hidden",
      "value": "standard",
      "choices": [
        { "name": "Standard", "value": "standard" },
        { "name": "FLARE Instruct", "value": "flare_instruct" }
      ],
      "binding": {
        "type": "zeebe:input",
        "name": "query.mode"
      }
    },
    {
      "label": "Result Expression",
      "description": "Expression to map the result into process variables. Result is in a temporary variable <code>result</code>, natural language answer is in <code>result.answer</code>.",
      "group": "output",
      "type": "Text",
      "feel": "required",
      "value": "={answer: result}",
      "binding": {
        "type": "zeebe:taskHeader",
        "key": "resultExpression"
      }
    },
    {
      "label": "Error Expression",
      "description": "Expression to handle errors. Details in the <a href=\"https://docs.camunda.io/docs/components/connectors/use-connectors/#bpmn-errors\" target=\"_blank\">documentation</a>",
      "group": "errors",
      "type": "Text",
      "feel": "required",
      "binding": {
        "type": "zeebe:taskHeader",
        "key": "errorExpression"
      }
    }
  ]
}
